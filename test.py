BASE = 2 ** 52

def f(arr, base=BASE):
    total = 0
    for index, num in enumerate(arr):
        total += num * (base ** index)
    return total

def inverse_f(x, base=BASE):
    if x < 0:
        raise ValueError("Only non-negative integers are supported")

    arr = []
    while x > 0:
        x, digit = divmod(x, base)
        arr.append(digit)
    return arr

def factorial(x):
    if x <= 1:
        return 1
    return factorial(x - 1) * x

number = factorial(400)
test = [0, 0, 0, 0, 0, 0, 0, 0, 0, 2667082416128000, 465906613826578, 2710515840931612, 270930000721971, 2461879872386034, 4378326770984671, 3578430117561213, 80781209843679, 2963682732305652, 2949377410241238, 3069011893441519, 4413447577585644, 1858976672404629, 1441586970054219, 2464675884561677, 1644659446798339, 2830267290238899, 1487080359649283, 405684709722232, 510287288904254, 1777435930553964, 576032385234510, 1245466219707638, 1223474103467042, 2723921218164848, 4163032966774812, 1152561569529276, 1019421399005633, 361097261839578, 1976904307222566, 1701481751601436, 3623941284923903, 515666954830699, 1083908986383442, 3038211768335341, 3703743938631952, 15294620051541, 1679687975988399, 1666702662554372, 2035714532562171, 224081865493673, 2189242108692512, 4092502468777782, 1354336512450851, 1000313512675979, 2563542077734554, 1954344823234143, 2156671591979128, 3783325856469633, 4155868161690010, 319567564489620, 606025232004784, 4350692911858292, 503389662864351, 4221000008862449, 1206813571009765, 2472404293151680, 134247431721211, 1013245798176621, 4372049302822724, 2840837018832222, 2655340041783807, 1337907708084115, 10717778]

print(number == f(test))
print(number)
print(f(test))
print(inverse_f(number))
print(test)
#       [4, 4503599627370492]

BASE = 2 ** 52

def f(arr):
    total = 0
    for index, num in enumerate(arr):
        total += num * (BASE ** index)
    return total

def inverse_f(x, base=BASE):
    if x < 0:
        raise ValueError("Only non-negative integers are supported")

    arr = []
    while x > 0:
        x, digit = divmod(x, base)
        arr.append(digit)
    return arr

def factorial(x):
    if x <= 1:
        return 1
    return factorial(x - 1) * x

number = factorial(400)
#      [958209396572160, 540]
test = [0, 0, 0, 0, 0, 0, 2387851492720640, 3887196256672661, 697066393504415, 3773110435642952, 3283881478433703, 88667289851895, 3821916180769640, 647896679090790, 948892686935646, 3998122100287321, 2704485797586862, 4080118191856842, 3489090921060031, 1298571879332852, 1968575133906869, 3801768698376132, 2150434564039358, 4254189512885787, 426508617928527, 2650138445532411, 256184319481952, 611301589050100, 2911024086346259, 4101167015023584, 3867014171317762, 966767172042563, 339483552999774, 1209153476580626, 1985722718617970, 4342806315190681, 1165600692619290, 3853418980652253, 1762642890270636, 1931594543820657, 522269596154218, 4503011786783739, 2336426524346126, 216405873400559, 3873734213428980, 1776288285077945, 1990417306460867, 23695]
print(number == f(test))
print(number)
print(f(test))
print(inverse_f(number))
print(test)
#       [4, 4503599627370492]
